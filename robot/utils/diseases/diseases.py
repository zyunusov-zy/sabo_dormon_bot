from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton


DIAGNOSES_RU = {
    1: "Лапароскопическая холецистэктомия",
    2: "Лапароскопическая эхинококкэктомия",
    3: "Лапароскопическая герниопластика",
    4: "Лапароскопическое устранение диастаза",
    5: "Лапароскопическая адгезиолизис (удаление спаек)",
    6: "Лапароскопические гинекологические операции",
    7: "Лапароскопическая фундопликация (по Ниссену или Тупе)",
    8: "Лапароскопическая адреналэктомия",
    9: "Лапароскопическая резекция печени",
    10: "Лапароскопическая резекция поджелудочной железы",
    11: "Лапароскопическая операция на желудке (SLEEVE, bypass)",
    12: "Лапароскопическая резекция желудка (гастрэктомия)",
    13: "Лапароскопическая гемиколэктомия или резекция прямой кишки",
    14: "Лапароскопическое вмешательство при тяжёлых состояниях",
    15: "Открытая холецистэктомия (традиционная)",
    16: "Открытые операции при грыжах",
    17: "Открытая эхинококкэктомия",
    18: "Тимпанопластика (восстановление барабанной перепонки)",
    19: "Септопластика (исправление перегородки носа)",
    20: "Тонзиллэктомия (удаление миндалин)",
    21: "Аденотомия (удаление аденоидов)",
    22: "Турбинопластика (коррекция носовых раковин)",
    23: "FESS — функциональная эндоскопическая операция на пазухах",
    24: "Оссикулопластика (восстановление слуховых косточек)",
    25: "Установка шунта в барабанную перепонку",
    26: "Экстирпация матки",
    27: "Экстирпация влагалища (частичная или полная)",
    28: "Ампутация матки и придатков",
    29: "Миомэктомия (удаление миомы с сохранением матки)",
    30: "Диагностическая гистероскопия и лапароскопия",
    31: "Лапароскопическая экстирпация матки + пластика таза",
    32: "TVT-лента + пластика (при недержании мочи)",
    33: "Кольпо/леваторопластика (восстановление мышц влагалища)",
    34: "Лапароскопическое удаление кисты яичника",
    35: "Лапароскопия при внематочной беременности",
    36: "Операция при опущении матки + пластика",
    37: "Гистерорезектоскопия (удаление полипов и миом)",
    38: "Операция при аденоме простаты (ТУР)",
    39: "Операция по Мармару при варикоцеле",
    40: "Лигаментотомия (удлинение полового члена)",
    41: "Фаллопротезирование",
    42: "Микроденервация полового члена (при быстром семяизвержении)",
    43: "Операция при гидроцеле (водянке яичка)",
    44: "Операция при паховых грыжах (открытая/лапароскопическая)",
    45: "Лапароскопическая нефрэктомия (удаление почки)",

    # Кардиология
    46: "Артериальная гипертензия — при контроле нормализуется давление, снижается риск инсульта и инфаркта.",
    47: "Сердечная недостаточность (начальные стадии) — при раннем лечении повышается выносливость, снижается смертность.",
    48: "Аритмии (некоторые виды) — медикаментозное лечение или контроль устраняет симптомы.",

    # Эндокринология
    49: "Сахарный диабет 2 типа (в начале) — контроль сахара, питание и снижение веса улучшают состояние.",
    50: "Гипотиреоз / гипертиреоз — гормональная коррекция убирает слабость, отёки, депрессию и др.",
    51: "Метаболический синдром — контроль веса и обмена веществ снижает риск инфаркта/инсульта.",

    # Гастроэнтерология
    52: "Язвенная болезнь желудка / гастрит (H. pylori) — эрадикация бактерии убирает боль, предотвращает рак.",
    53: "Хронический гепатит B или C — современная противовирусная терапия.",
    54: "Синдром раздражённого кишечника — лечение и психотерапия улучшают качество жизни.",

    # Неврология и психиатрия
    55: "Эпилепсия (контролируемая) — правильно подобранная терапия даёт возможность полноценной жизни.",
    56: "Тревожные расстройства / депрессия — лечение убирает апатию, восстанавливает работоспособность.",
    57: "СДВГ (у подростков) — терапия улучшает учёбу, поведение и адаптацию.",
    58: "Посттравматическое стрессовое расстройство (ПТСР)",
}


DIAGNOSES_PER_PAGE = 10

def get_diagnoses_page(page: int = 1):
    start = (page - 1) * DIAGNOSES_PER_PAGE
    end = start + DIAGNOSES_PER_PAGE

    items = list(DIAGNOSES_RU.items())[start:end]
    total_pages = (len(DIAGNOSES_RU) + DIAGNOSES_PER_PAGE - 1) // DIAGNOSES_PER_PAGE

    # Форматируем список диагнозов в текст
    text = "\n".join([f"<b>{k}.</b> {v}" for k, v in items])

    # Кнопки с номерами
    number_buttons = [
        InlineKeyboardButton(text=str(k), callback_data=f"diagnosis_select_{k}")
        for k, _ in items
    ]

    # Разделим кнопки по рядам по 5 штук
    rows = [number_buttons[i:i+5] for i in range(0, len(number_buttons), 5)]

    # Добавим пагинацию
    navigation = []
    if page > 1:
        navigation.append(InlineKeyboardButton(text="⬅️ Назад", callback_data=f"diagnosis_page_{page - 1}"))
    if page < total_pages:
        navigation.append(InlineKeyboardButton(text="➡️ Далее", callback_data=f"diagnosis_page_{page + 1}"))

    if navigation:
        rows.append(navigation)

    markup = InlineKeyboardMarkup(inline_keyboard=rows)

    return text, markup
